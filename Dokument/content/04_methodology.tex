\chapter{Gesamtkonzept Softwareplattform}

In diesem Kapitel wird anhand der Anforderungen aus dem Forschungsansatz eine Gesamtarchitektur des Softwareplattforms vorgestellt, sowie die Softwarearchitektur der beiden Softwarekomponenten \enquote{Runtime Node} und \enquote{Runtime Master}. 

\section{Verteiltes Rechenplattform aus autonomen Fahrzeugsteuergeräten}

Die Rechenleistung von autonomen Fahrzeugen kann in verschiedenen Nutzungskonzepten verwendet werden. Im Kapitel \autoref{Hardwareumgebung in Fahrzeugen} wurde die Hardware vorgestellt, die typischerweise in autonomen Fahrzeugsteuergeräten zu finden ist. Es wird deutlich, dass diese Steuergeräte über Hardwaremodule verfügen, die die Rechenleistung für spezifische Rechenoperationen erhöhen. Grafikprozessoren beinhalten viele Rechenkerne, die parallel auf gro0en Datenmengen opreationen ausführen können. In den meisten Architekturen können die GPU-Cores nur in Gruppen verwendet werden, wobei jede Gruppe die gleiche Rechenoperation ausführen muss. Kerne für Neuronale Netzwerk Berechnungen implementieren Matrix Operationen in Hardware, so dass diese in erheblich weniger Rechenzyklen als bei sequentieller Berechnung durchgeführt werden können. Folglich können nur solche Rechenaufgaben sinnvoll auf diese Steuergeräte ausgelagert werden, die sich in viele parallele Berechnungen aufteilen lassen. Typische Beispiele für solche Berechnungen sind:

\begin{itemize}
    \item Mathematik: Vektor und Matrixoperationen
    \item Bildbearbeitung: FFT oder Faltungsoperationen
    \item Simulation: Moleküldynamik, Finite-Elemente Analyze, Fluiddynamik
    \item Finanzsegment: Monte Carlo Simulation, Optionspreisgestaltung, Portfolio Optimierung
    \item Kryptographie und Sicherheit: Hashing Algorithmen, Passwortknacken, Blockchain und Kryptowährung Mining
    \item Datenanalyse in Naturwissenschaften: Genomische und bioinformatische Berechnungen, Big Data Verarbeitung
    \item Optimerung: Genetische Algorithmen Berechnungen
    \item Quantum Computing: Simulation von Quantumsystemen
\end{itemize}

Die Neuronale Netzwerk Beschleuniger können zudem für das Trainieren von neuronalen Netzwerken effizient verwendet werden. 

Trotz der Einschränkung in der Art der Rechenaufgaben, die auf der Hardware effizient berechnet werden können, ergibt sich eine Vielzahl möglicher Anwendungsszenarien. Die ungenutzte Rechenleistung kann also von verschiedenen Kunden sinnvoll verwendet werden. Folgende Ansätze für die Bereitstellung der Ressourcen an Kunden wären Denkbar:

\begin{itemize}
    \item Nutzung ausschließlich durch den Hersteller: Diese Methode ist die transparenteste und sicherste Methode für den Fahrzeughersteller. Nur der Hersteller selber Applikationen auf die Fahrzeuge ausrollen und die ungenutzte Rechenleistung nutzen
    \item Nutzung durch Hersteller und ausgewählte Kunden: Der Hersteller stellt die Rechenleistung auch an ausgewählte Kunden zur Verfügung, hierbei vertraut der Hersteller den Kunden, dass sie keine illegale Aktivitäten ausüben und nicht aktiv Versuchen Schutzmechanismen des Systems umzugehen.
    \item Nutzung durch frei verfügbaren Marktplatz: Beliebige Kunden können auf dem Marktplatz Rechenleistung einkaufen. In diesem Konzept muss sichergestellt werden dass Kunden keine illegale Aktivitäten ausüben und dass sie die Sicherheitsmechanismen des Plattforms nicht versuchen zu umgehen.
\end{itemize}

Für die ersten Versionen eines solchen Plattforms würden realistisch nur die ersten Beiden Möglichkeiten in Frage kommen. Eine freie Nutzung erfordert sehr hohe Sicherheitsstandards für die Plattform, die mit erheblichem Entwicklungs- und Erfahrungsaufwand verbunden sind. 

Die Nutzung freier Rechenressourcen erhöht den Stromverbrauch des Fahrzeugs. Daher müssen Anreize für die Nutzer geschaffen werden, die Rechenleistung des Fahrzeugs freizugeben. Hier können ähnliche Konzepte wie in der Informatik verwendet werden. Es gibt verschiedene Plattformen, auf denen PC-Nutzer ihre Rechenleistung zur Verfügung stellen können. 

Plattformen, die auf freiwilliger Teilnahme und Bereitstellung von Rechenressourcen beruhen, haben sich als erfolgreich erwiesen. Voraussetzung ist, dass die Rechenleistung nur für Zwecke eingesetzt wird, die von der Gesellschaft als gemeinnützig und sinnvoll erachtet werden. Ein verbreitetes Beispiel ist das Projekt \gls{BOINC}. In diesem Projekt können Nutzer ihre ungenutzte Rechenleistung für verschiedene naturwissenschaftliche Projekte zur Verfügung stellen.  \gls{BOINC} stellt die Rechenleistung für verschiedene Anwendungen in Bereichen wie Medizintechnik, Biologie, Mathematik, Linguistik, Klimaforschung, Umweltwissenschaften, Astrophysik zur Verfügung. Die teilnehmenden Nutzer erhalten Punkte für die im Projekt erbrachte Rechenleistung. Diese Punkte können jedoch nicht eingelöst werden und dienen lediglich der Nachvollziehbarkeit und Vergleichbarkeit der erbrachten Rechenleistung unter den Nutzern. Ein ähnliches Konzept könnte daher auch für die Nutzung der freien Rechenleistung von Fahrzeugen erfolgreich sein, sofern die Rechenleistung für gemeinnützige Zwecke genutzt wird.

Wenn eine kommerzielle Nutzung der Rechenleistung vorgesehen ist, müssen die Nutzer, die Rechenleistung zur Verfügung stellen, entlohnt werden. Viele Plattformen im IT-Bereich setzen dabei auf die Bezahlung mit Kryptowährungen. Dies hat den Vorteil, dass die Zahlungsbedingungen direkt im Blockchain-Vertrag festgehalten werden können, sodass kein Vertrauen in die Einhaltung der Bedingungen durch den Plattformbetreiber erforderlich ist. Exemplarisch kann in diesem Kontext das Golem-Projekt betrachtet werden. 

Das Konzept sieht die Implementierung eines Markplatzes vor, wo Benutzer Rechenleistung einkaufen und verkaufen können. Die Erstellung der Rechenaufgaben kann auf zwei verschiedene Arten erfolgen. Entweder werden bereits kompatible Funktionscodes in Form von Vorlagen genutzt, oder die Funktionscodes werden vom Benutzer implementiert. Die Aufgabenverwaltung registriert die neue Aufgabe, welche durch einen Benutzer angestoßen wurde. Der Benutzer, der die Rechenleistung der Plattform in Anspruch nehmen möchte, erstellt ein Angebot, in dem er die Höhe der Vergütung angibt. Diese Angebote werden auf dem Netzwerk an allen Benutzer übertragen, die Rechenleistung zur Verfügung stellen. Zusätzlich kann das Angebot Einschränkungen bezüglich der Hardware oder geographische Lage beinhalten.

Die Bereitstellung von Rechenleistung erfolgt durch die lokalen Ausführungen eines Transaktionssystem-Moduls durch die jeweiligen Benutzer. Dieser Modul sammelt alle verfügbaren Aufgabenangebote im Netzwerk und wählt das beste Angebot aus. Des Weiteren verfügt auch derjenige, der ein Angebot erstellt, über eine Reputation auf der Plattform. Angebote von Benutzern, deren Reputation als zu gering erachtet wird, werden abgelehnt. Sofern alle Anforderungen des Angebots durch den Rechenleistung-Bereitsteller erfüllt sind, wird das Angebot angenommen. 

Die Rechenaufgabe, inklusive benötigte Ressourcen wird auf den PC vom Rechenleistung-Bereitsteller heruntergeladen. Der PC berechnet im Anschluss die entsprechende Aufgabe. Der Rechenleistung-Bereitsteller kann die geladenen Anwendungen in verschiedenen Umgebungen ausführen. Es kann eine Virtualisierungsmethode wie Container oder virtuelle Maschine verwendet werden, um die Anwendungen vom Hostsystem zu isolieren, oder es kann direkt auf dem Hostsystem ausgeführt werden, wenn die Anwendung als vertrauenswürdig eingestuft wird. 

Nach der Berechnung der Aufgabe werden die Ergebnisse und Protokolle an den Auftraggeber zurückgeschickt. Die Aufgabenverwaltung validiert die Ergebnisse, indem entweder Teile der Aufgabe von anderen Teilnehmern redundant berechnet werden oder Teile lokal berechnet und überprüft werden. Sind die Ergebnisse erfolgreich validiert, wird der Benutzer, der die Rechenleistung erbracht hat, entsprechend dem Angebot bezahlt. Falls die Ergebnisse nicht korrekt sind, wird die Reputation des Rechenleistung-Bereitstellers verringert. 

Ein Konzept wie es im Golem-Projekt umgesetzt wurde, eignet sich auch für die Bereitstellung von Fahrzeugrechenressourcen im kommerziellen Einsatz. Dieses Konzept kann vereinfacht werden, wenn die Plattform vom Hersteller betrieben wird. Der Hersteller kann eine zentrale Zahlungsinstanz betreiben, so dass keine Kryptowährung als Zahlungsmittel verwendet werden muss. In diesem Fall wird der Hersteller als vertrauenswürdiger Betreiber angesehen, der die Auszahlung pflichtgemäß ausführt. Die Überprüfung der berechneten Daten und damit die Beurteilung der Vertrauenswürdigkeit der einzelnen Teilnehmer kann stark vereinfacht oder ganz weggelassen werden. Die Software für die Steuergeräte kommt vom Hersteller, so dass ein Eingriff durch den Kunden deutlich schwieriger und unwahrscheinlicher ist. Eine Isolierung vom restlichen System ist aber auch dann sinnvoll, wenn nur der Hersteller externe Applikationen auf die Steuergeräte auslagern kann. Auch wenn ein Missbrauch ausgeschlossen werden kann, kann ein unbeabsichtigter Fehler bei unzureichender Isolierung dennoch zu einem Sicherheitsrisiko führen. 

\section{Architektur der Softwareplattform}

Die prototypische Implementierung der Plattform orientiert sich in ihrer Architektur an bestehenden Systemen aus der Informationstechnik. Wie im \autoref{Forschungsansatz} erarbeitet, besteht die Plattform aus zwei Hauptkomponenten. Die \enquote{Runtime Node} Komponente läuft auf den Fahrzeugsteuergeräten und ist im gesamten Netzwerk mehrfach vorhanden. Die Komponente \enquote{Runtime Master} ist einmal im Netzwerk vorhanden und verwaltet die \enquote{Runtime Node} Komponenten. Eine Gesamtarchitektur ist in der \autoref{architektur} dargestellt.

\begin{figure}[htbp]
	\centering
	\includegraphics[width=\textwidth]{./content/graphics/Architecture.pdf}
	\caption{Gesamtarchitektur der Softwareplattform}
	\label{architektur}
\end{figure}

\subsection{Runtime Node}

Diese Komponente wird auf den Fahrzeugsteuergeräten ausgeführt und setzt sich aus mehreren Softwarekomponenten zusammen. Die Kommunikationsschnittstelle wird als eigenständige Softwarekomponente implementiert, die nicht Teil der Softwarekomponente Runtime Node ist. Diese Struktur ermöglicht einen einfachen Austausch der Kommunikationsschnittstelle und damit einen einfachen Wechsel des Kommunikationsprotokolls. Die Kommunikation zwischen der Kommunikationsschnittstelle und dem Runtime Node erfolgt über eine Interprozesskommunikationssockel. Die Informationen werden im \gls{JSON} Format übertragen. Der Runtime Node interpretiert die eingehenden Befehle mit einem JSON-Parser-Modul. Statusrückmeldungen vom Runtime Node werden ebenfalls als JSON an die Kommunikationsschnittstelle gesendet. 

\begin{figure}[htbp]
	\centering
	\includegraphics[width=\textwidth]{./content/graphics/Runtime_Node_Arch.pdf}
	\caption{Runtime Node Struktur}
	\label{runtime node}
\end{figure}

\subsection{Runtime Master}

\begin{figure}[htbp]
	\centering
	\includegraphics[width=\textwidth]{./content/graphics/Runtime_Master_Arch.pdf}
	\caption{Runtime Master Struktur}
	\label{runtime master}
\end{figure}

\subsection{Kommunikation}

Innerhalb des Systems findet Kommunikation sowohl zwischen den Fahrzeugen als auch zwischen den einzelnen Softwarekomponenten statt. Diese unterschiedlichen Kommunikationsarten stellen unterschiedliche Anforderungen an die verwendete Kommunikationsschnittstelle. Diese werden im folgenden Abschnitt dargestellt.

\subsubsection{Kommunikation zwischen Fahrzeugen und Runtime Master}

Die Fahrzeuge bilden ein verteiltes System, das von einer Runtime Master Instanz verwaltet wird. Die Kommunikation zwischen Fahrzeugen und Runtime Node wird voraussichtlich über Internetverbindung umgesetzt. Denkbar wäre auch ein Netzwerk, welches vom Fahrzeughersteller gestellt wird, und ähnlich wie Internetverbindung über Handynetz verfügbar ist. 



